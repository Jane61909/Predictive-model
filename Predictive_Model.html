<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roshani Gladson">
<meta name="dcterms.date" content="2024-09-29">

<title>Quarto Document Template for R and Python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Predictive_Model_files/libs/clipboard/clipboard.min.js"></script>
<script src="Predictive_Model_files/libs/quarto-html/quarto.js"></script>
<script src="Predictive_Model_files/libs/quarto-html/popper.min.js"></script>
<script src="Predictive_Model_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Predictive_Model_files/libs/quarto-html/anchor.min.js"></script>
<link href="Predictive_Model_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Predictive_Model_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Predictive_Model_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Predictive_Model_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Predictive_Model_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#python" id="toc-python" class="nav-link active" data-scroll-target="#python">Python</a>
  <ul class="collapse">
  <li><a href="#step-1" id="toc-step-1" class="nav-link" data-scroll-target="#step-1">step 1</a>
  <ul class="collapse">
  <li><a href="#step-1---python" id="toc-step-1---python" class="nav-link" data-scroll-target="#step-1---python">step 1 - Python</a></li>
  </ul></li>
  <li><a href="#step-2" id="toc-step-2" class="nav-link" data-scroll-target="#step-2">step 2</a>
  <ul class="collapse">
  <li><a href="#step-2---python" id="toc-step-2---python" class="nav-link" data-scroll-target="#step-2---python">step 2 - Python</a></li>
  </ul></li>
  <li><a href="#step-3" id="toc-step-3" class="nav-link" data-scroll-target="#step-3">step 3</a>
  <ul class="collapse">
  <li><a href="#step-3---python" id="toc-step-3---python" class="nav-link" data-scroll-target="#step-3---python">step 3 - Python</a></li>
  </ul></li>
  <li><a href="#step-4" id="toc-step-4" class="nav-link" data-scroll-target="#step-4">step 4</a>
  <ul class="collapse">
  <li><a href="#step-4---python" id="toc-step-4---python" class="nav-link" data-scroll-target="#step-4---python">step 4 - Python</a></li>
  </ul></li>
  <li><a href="#step-5" id="toc-step-5" class="nav-link" data-scroll-target="#step-5">step 5</a>
  <ul class="collapse">
  <li><a href="#step-5---python" id="toc-step-5---python" class="nav-link" data-scroll-target="#step-5---python">step 5 - Python</a></li>
  </ul></li>
  <li><a href="#step-6" id="toc-step-6" class="nav-link" data-scroll-target="#step-6">step 6</a>
  <ul class="collapse">
  <li><a href="#step-6---python" id="toc-step-6---python" class="nav-link" data-scroll-target="#step-6---python">step 6 - Python</a></li>
  </ul></li>
  <li><a href="#step-7" id="toc-step-7" class="nav-link" data-scroll-target="#step-7">step 7</a>
  <ul class="collapse">
  <li><a href="#step-7---python" id="toc-step-7---python" class="nav-link" data-scroll-target="#step-7---python">step 7 - Python</a></li>
  </ul></li>
  <li><a href="#step-8" id="toc-step-8" class="nav-link" data-scroll-target="#step-8">step 8</a></li>
  <li><a href="#step-9" id="toc-step-9" class="nav-link" data-scroll-target="#step-9">step 9</a>
  <ul class="collapse">
  <li><a href="#step-9---python" id="toc-step-9---python" class="nav-link" data-scroll-target="#step-9---python">step 9 - Python</a></li>
  </ul></li>
  <li><a href="#final-analysis" id="toc-final-analysis" class="nav-link" data-scroll-target="#final-analysis">Final Analysis</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quarto Document Template for R and Python</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Roshani Gladson </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="python" class="level1">
<h1>Python</h1>
<section id="step-1" class="level2">
<h2 class="anchored" data-anchor-id="step-1">step 1</h2>
<p>check for missing values in the dataset</p>
<section id="step-1---python" class="level3">
<h3 class="anchored" data-anchor-id="step-1---python">step 1 - Python</h3>
<div id="eb259d3c" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV, RandomizedSearchCV</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, accuracy_score, classification_report</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"C:/Users/Harri/Downloads/"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> pd.read_csv(path <span class="op">+</span> <span class="st">"campaign_offer_rev-1.csv"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values and dataset info</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred.isnull().<span class="bu">sum</span>())</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred.shape)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred.info())</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing values with mean</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>mean_imputer <span class="op">=</span> SimpleImputer(missing_values<span class="op">=</span>np.nan, strategy<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">'Age'</span>, <span class="st">'Income'</span>, <span class="st">'Recency'</span>, <span class="st">'AcceptedCmpOverall'</span>]:</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    pred[col] <span class="op">=</span> mean_imputer.fit_transform(pred[col].values.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CustID                  0
Marital_Status          0
Education               0
Kidhome                 0
Teenhome                0
AcceptedCmp3            0
AcceptedCmp4            0
AcceptedCmp5            0
AcceptedCmp1            0
AcceptedCmp2            0
Complain                0
Income                302
Age                   129
Recency               447
MntWines                0
MntFruits               0
MntMeatProducts         0
MntFishProducts         0
MntSweetProducts        0
MntGoldProds            0
NumDealsPurchases       0
NumWebPurchases         0
NumAppPurchases         0
NumStorePurchases       0
NumWebVisitsMonth       0
MntTotal                0
MntRegularProds         0
AcceptedCmpOverall    322
Response                0
dtype: int64
(2205, 29)
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2205 entries, 0 to 2204
Data columns (total 29 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   CustID              2205 non-null   int64  
 1   Marital_Status      2205 non-null   object 
 2   Education           2205 non-null   object 
 3   Kidhome             2205 non-null   object 
 4   Teenhome            2205 non-null   object 
 5   AcceptedCmp3        2205 non-null   int64  
 6   AcceptedCmp4        2205 non-null   int64  
 7   AcceptedCmp5        2205 non-null   int64  
 8   AcceptedCmp1        2205 non-null   int64  
 9   AcceptedCmp2        2205 non-null   int64  
 10  Complain            2205 non-null   int64  
 11  Income              1903 non-null   float64
 12  Age                 2076 non-null   float64
 13  Recency             1758 non-null   float64
 14  MntWines            2205 non-null   int64  
 15  MntFruits           2205 non-null   int64  
 16  MntMeatProducts     2205 non-null   int64  
 17  MntFishProducts     2205 non-null   int64  
 18  MntSweetProducts    2205 non-null   int64  
 19  MntGoldProds        2205 non-null   int64  
 20  NumDealsPurchases   2205 non-null   int64  
 21  NumWebPurchases     2205 non-null   int64  
 22  NumAppPurchases     2205 non-null   int64  
 23  NumStorePurchases   2205 non-null   int64  
 24  NumWebVisitsMonth   2205 non-null   int64  
 25  MntTotal            2205 non-null   int64  
 26  MntRegularProds     2205 non-null   int64  
 27  AcceptedCmpOverall  1883 non-null   float64
 28  Response            2205 non-null   int64  
dtypes: float64(4), int64(21), object(4)
memory usage: 499.7+ KB
None</code></pre>
</div>
</div>
</section>
</section>
<section id="step-2" class="level2">
<h2 class="anchored" data-anchor-id="step-2">step 2</h2>
<p>perform any necessary coercions</p>
<section id="step-2---python" class="level3">
<h3 class="anchored" data-anchor-id="step-2---python">step 2 - Python</h3>
<div id="5de790ad" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert 'Kidhome' and 'Teenhome' to binary</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Kidhome'</span>] <span class="op">=</span> pd.to_numeric(pred[<span class="st">'Kidhome'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Teenhome'</span>] <span class="op">=</span> pd.to_numeric(pred[<span class="st">'Teenhome'</span>], errors<span class="op">=</span><span class="st">'coerce'</span>).fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Kidhome'</span>] <span class="op">=</span> pred[<span class="st">'Kidhome'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="va">True</span> <span class="cf">if</span> x <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="va">False</span>).astype(<span class="st">'bool'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Teenhome'</span>] <span class="op">=</span> pred[<span class="st">'Teenhome'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="va">True</span> <span class="cf">if</span> x <span class="op">&gt;=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="va">False</span>).astype(<span class="st">'bool'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred.info())</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred.isnull().<span class="bu">sum</span>())</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of the target variable</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Response'</span>] <span class="op">=</span> pred[<span class="st">'Response'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pred[<span class="st">'Response'</span>].value_counts())</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>pred[<span class="st">'Response'</span>].value_counts().plot.bar()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2205 entries, 0 to 2204
Data columns (total 29 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   CustID              2205 non-null   int64  
 1   Marital_Status      2205 non-null   object 
 2   Education           2205 non-null   object 
 3   Kidhome             2205 non-null   bool   
 4   Teenhome            2205 non-null   bool   
 5   AcceptedCmp3        2205 non-null   int64  
 6   AcceptedCmp4        2205 non-null   int64  
 7   AcceptedCmp5        2205 non-null   int64  
 8   AcceptedCmp1        2205 non-null   int64  
 9   AcceptedCmp2        2205 non-null   int64  
 10  Complain            2205 non-null   int64  
 11  Income              2205 non-null   float64
 12  Age                 2205 non-null   float64
 13  Recency             2205 non-null   float64
 14  MntWines            2205 non-null   int64  
 15  MntFruits           2205 non-null   int64  
 16  MntMeatProducts     2205 non-null   int64  
 17  MntFishProducts     2205 non-null   int64  
 18  MntSweetProducts    2205 non-null   int64  
 19  MntGoldProds        2205 non-null   int64  
 20  NumDealsPurchases   2205 non-null   int64  
 21  NumWebPurchases     2205 non-null   int64  
 22  NumAppPurchases     2205 non-null   int64  
 23  NumStorePurchases   2205 non-null   int64  
 24  NumWebVisitsMonth   2205 non-null   int64  
 25  MntTotal            2205 non-null   int64  
 26  MntRegularProds     2205 non-null   int64  
 27  AcceptedCmpOverall  2205 non-null   float64
 28  Response            2205 non-null   int64  
dtypes: bool(2), float64(4), int64(21), object(2)
memory usage: 469.6+ KB
None
CustID                0
Marital_Status        0
Education             0
Kidhome               0
Teenhome              0
AcceptedCmp3          0
AcceptedCmp4          0
AcceptedCmp5          0
AcceptedCmp1          0
AcceptedCmp2          0
Complain              0
Income                0
Age                   0
Recency               0
MntWines              0
MntFruits             0
MntMeatProducts       0
MntFishProducts       0
MntSweetProducts      0
MntGoldProds          0
NumDealsPurchases     0
NumWebPurchases       0
NumAppPurchases       0
NumStorePurchases     0
NumWebVisitsMonth     0
MntTotal              0
MntRegularProds       0
AcceptedCmpOverall    0
Response              0
dtype: int64
Response
0    1872
1     333
Name: count, dtype: int64</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Predictive_Model_files/figure-html/cell-3-output-2.png" width="583" height="425" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="step-3" class="level2">
<h2 class="anchored" data-anchor-id="step-3">step 3</h2>
<p>selected features: excluded features:complaint and CustID Complain: This column has little to no correlation with other columns, this will not be useful in predicting the target column CustID: This is just an identifier and does not contain predictive information.</p>
<p>choosing these features: I ran a correlation matrix and found AcceptedCmp1, AcceptedCmp2, AcceptedCmp3, AcceptedCmp5, AcceptedCmpOverall to have positive correlation with the target column and have strong correlations with AcceptedCmpOverall. In addition, I ran feature selection plot to see which features were useful in the overall accuracy for both decision trees and random forests. With all these considerations including my initution I included features that were useful but also made sure to have enough to give the model as much access as possible.</p>
<section id="step-3---python" class="level3">
<h3 class="anchored" data-anchor-id="step-3---python">step 3 - Python</h3>
<div id="c1082d9a" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define features and target</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AcceptedCmpOverall'</span>, <span class="st">'MntTotal'</span>, <span class="st">'MntRegularProds'</span>, <span class="st">'MntWines'</span>, <span class="st">'MntMeatProducts'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NumAppPurchases'</span>, <span class="st">'Recency'</span>, <span class="st">'NumWebVisitsMonth'</span>, <span class="st">'Income'</span>, <span class="st">'Age'</span>, <span class="st">'Marital_Status'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Education'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pred[features]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pred[<span class="st">'Response'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-4" class="level2">
<h2 class="anchored" data-anchor-id="step-4">step 4</h2>
<p>I used to categorical encoding, however I did not standardized or normalize since they aren’t sensitive to feature scales since they split based on feature values directly</p>
<section id="step-4---python" class="level3">
<h3 class="anchored" data-anchor-id="step-4---python">step 4 - Python</h3>
<div id="f4a08d36" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define pipelining steps</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>numeric_features <span class="op">=</span> [<span class="st">'AcceptedCmpOverall'</span>, <span class="st">'MntTotal'</span>, <span class="st">'MntRegularProds'</span>, <span class="st">'MntWines'</span>, <span class="st">'MntMeatProducts'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'NumAppPurchases'</span>, <span class="st">'Recency'</span>, <span class="st">'NumWebVisitsMonth'</span>, <span class="st">'Income'</span>, <span class="st">'Age'</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> [<span class="st">'Marital_Status'</span>, <span class="st">'Education'</span>]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create transformers</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>numeric_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'imputer'</span>, SimpleImputer(strategy<span class="op">=</span><span class="st">'mean'</span>)),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'scaler'</span>, StandardScaler())</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>categorical_transformer <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'onehot'</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">'ignore'</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine preprocessing steps</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    transformers<span class="op">=</span>[</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'num'</span>, numeric_transformer, numeric_features),</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        (<span class="st">'cat'</span>, categorical_transformer, categorical_features)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-5" class="level2">
<h2 class="anchored" data-anchor-id="step-5">step 5</h2>
<p>split the training and test set, test size is 20%</p>
<section id="step-5---python" class="level3">
<h3 class="anchored" data-anchor-id="step-5---python">step 5 - Python</h3>
<div id="d3127441" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>, stratify<span class="op">=</span>y)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the data</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>X_train_transformed <span class="op">=</span> preprocessor.fit_transform(X_train)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>X_test_transformed <span class="op">=</span> preprocessor.transform(X_test)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get feature names after preprocessing</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>encoded_feature_names <span class="op">=</span> (</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    numeric_features <span class="op">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span>(preprocessor.named_transformers_[<span class="st">'cat'</span>][<span class="st">'onehot'</span>].get_feature_names_out(categorical_features))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="step-6" class="level2">
<h2 class="anchored" data-anchor-id="step-6">step 6</h2>
<p>I chose Decision trees because our dataset structure is not linear in nature and this model handles non-linear patterns, can manage interactions between features (important given the correlations), and doesn’t require intensive preprocessing.</p>
<section id="step-6---python" class="level3">
<h3 class="anchored" data-anchor-id="step-6---python">step 6 - Python</h3>
<div id="afc1d552" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to train the initial model</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_model1(X_train, y_train, X_test, y_test):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="co"># Apply SMOTE to address class imbalance</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the model</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    model1 <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    model1.fit(X_train_smote, y_train_smote)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # Train the model</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model1 = DecisionTreeClassifier(random_state=42)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model1.fit(X_train, y_train)</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict and evaluate</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model1.predict(X_test)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Model1 Accuracy:"</span>, accuracy_score(y_test, y_pred))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Confusion Matrix:</span><span class="ch">\n</span><span class="st">"</span>, confusion_matrix(y_test, y_pred))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Classification Report:</span><span class="ch">\n</span><span class="st">"</span>, classification_report(y_test, y_pred))</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model1</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to train the best model with hyperparameter tuning</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_best_model1(X_train, y_train, X_test, y_test, feature_names):</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define parameter grid for GridSearchCV</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    param_grid <span class="op">=</span> {</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>],</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize and fit the model with GridSearchCV</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    grid_search <span class="op">=</span> GridSearchCV(DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>), param_grid, cv<span class="op">=</span><span class="dv">5</span>, scoring<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    grid_search.fit(X_train, y_train)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the best model</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    best_model1 <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best Parameters:"</span>, grid_search.best_params_)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict and evaluate</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> best_model1.predict(X_test)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best Model1 Accuracy:"</span>, accuracy_score(y_test, y_pred))</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Confusion Matrix:</span><span class="ch">\n</span><span class="st">"</span>, confusion_matrix(y_test, y_pred))</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Classification Report:</span><span class="ch">\n</span><span class="st">"</span>, classification_report(y_test, y_pred))</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract and plot feature importance</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    feature_importances <span class="op">=</span> best_model1.feature_importances_</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    feature_importance_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Feature'</span>: feature_names,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Importance'</span>: feature_importances</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    }).sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Feature Importances:</span><span class="ch">\n</span><span class="st">"</span>, feature_importance_df)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot feature importances</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    plt.barh(feature_importance_df[<span class="st">'Feature'</span>], feature_importance_df[<span class="st">'Importance'</span>], color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Feature Importance"</span>)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Features"</span>)</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"Feature Importance for Best Model"</span>)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>    plt.gca().invert_yaxis()  <span class="co"># Invert the y-axis for better readability</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_model1</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate the initial model</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> train_model1(X_train_transformed, y_train, X_test_transformed, y_test)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate the best model with the updated function</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>best_model1 <span class="op">=</span> train_best_model1(X_train_transformed, y_train, X_test_transformed, y_test, encoded_feature_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model1 Accuracy: 0.8163265306122449
Confusion Matrix:
 [[329  45]
 [ 36  31]]
Classification Report:
               precision    recall  f1-score   support

           0       0.90      0.88      0.89       374
           1       0.41      0.46      0.43        67

    accuracy                           0.82       441
   macro avg       0.65      0.67      0.66       441
weighted avg       0.83      0.82      0.82       441

Best Parameters: {'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2}
Best Model1 Accuracy: 0.8639455782312925
Confusion Matrix:
 [[367   7]
 [ 53  14]]
Classification Report:
               precision    recall  f1-score   support

           0       0.87      0.98      0.92       374
           1       0.67      0.21      0.32        67

    accuracy                           0.86       441
   macro avg       0.77      0.60      0.62       441
weighted avg       0.84      0.86      0.83       441


Feature Importances:
                     Feature  Importance
0        AcceptedCmpOverall    0.682011
6                   Recency    0.157784
7         NumWebVisitsMonth    0.055405
4           MntMeatProducts    0.055164
8                    Income    0.025504
9                       Age    0.024132
13  Marital_Status_Together    0.000000
18            Education_PhD    0.000000
17        Education_Masters    0.000000
16     Education_HighSchool    0.000000
15      Education_Bachelors    0.000000
14     Marital_Status_Widow    0.000000
10  Marital_Status_Divorced    0.000000
12    Marital_Status_Single    0.000000
11   Marital_Status_Married    0.000000
1                  MntTotal    0.000000
5           NumAppPurchases    0.000000
3                  MntWines    0.000000
2           MntRegularProds    0.000000
19      Education_Secondary    0.000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Predictive_Model_files/figure-html/cell-7-output-2.png" width="952" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="step-7" class="level2">
<h2 class="anchored" data-anchor-id="step-7">step 7</h2>
<p>I chose Random forest next because for its ability to handle non-linear relationships and interactions between features</p>
<section id="step-7---python" class="level3">
<h3 class="anchored" data-anchor-id="step-7---python">step 7 - Python</h3>
<div id="59b0ddd8" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to train the initial Random Forest model with SMOTE</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_model2(X_train, y_train, X_test, y_test):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply SMOTE to address class imbalance</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the initial Random Forest model</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    model2 <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    model2.fit(X_train_smote, y_train_smote)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict and evaluate</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> model2.predict(X_test)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Model2 Accuracy:"</span>, accuracy_score(y_test, y_pred))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Confusion Matrix:</span><span class="ch">\n</span><span class="st">"</span>, confusion_matrix(y_test, y_pred))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Classification Report:</span><span class="ch">\n</span><span class="st">"</span>, classification_report(y_test, y_pred))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model2</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to train the best Random Forest model with hyperparameter tuning and SMOTE</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_best_model2(X_train, y_train, X_test, y_test, feature_names):</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply SMOTE to address class imbalance</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train, y_train)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the parameter grid for RandomizedSearchCV</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    param_dist <span class="op">=</span> {</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'n_estimators'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>],</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_depth'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="va">None</span>],</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_samples_split'</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_samples_leaf'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'bootstrap'</span>: [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize RandomizedSearchCV for Random Forest</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    randomized_search <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        param_distributions<span class="op">=</span>param_dist,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        n_iter<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        scoring<span class="op">=</span><span class="st">'accuracy'</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model with RandomizedSearchCV using SMOTE data</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    randomized_search.fit(X_train_smote, y_train_smote)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the best model found by RandomizedSearchCV</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    best_model2 <span class="op">=</span> randomized_search.best_estimator_</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best Parameters:"</span>, randomized_search.best_params_)</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict and evaluate</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> best_model2.predict(X_test)</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Best Model2 Accuracy:"</span>, accuracy_score(y_test, y_pred))</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Confusion Matrix:</span><span class="ch">\n</span><span class="st">"</span>, confusion_matrix(y_test, y_pred))</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Classification Report:</span><span class="ch">\n</span><span class="st">"</span>, classification_report(y_test, y_pred))</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract and plot feature importance</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    feature_importances <span class="op">=</span> best_model2.feature_importances_</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    feature_importance_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Feature'</span>: feature_names,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Importance'</span>: feature_importances</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    }).sort_values(by<span class="op">=</span><span class="st">'Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Feature Importances:</span><span class="ch">\n</span><span class="st">"</span>, feature_importance_df)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot feature importances</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    plt.barh(feature_importance_df[<span class="st">'Feature'</span>], feature_importance_df[<span class="st">'Importance'</span>], color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">"Feature Importance"</span>)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">"Features"</span>)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">"Feature Importance for Best Model"</span>)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    plt.gca().invert_yaxis()  <span class="co"># Invert the y-axis for better readability</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_model2</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate the initial Random Forest model</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> train_model2(X_train_transformed, y_train, X_test_transformed, y_test)</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate the best Random Forest model with hyperparameter tuning</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> encoded_feature_names  <span class="co"># Replace with the list of feature names after preprocessing</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>best_model2 <span class="op">=</span> train_best_model2(X_train_transformed, y_train, X_test_transformed, y_test, feature_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model2 Accuracy: 0.8684807256235828
Confusion Matrix:
 [[355  19]
 [ 39  28]]
Classification Report:
               precision    recall  f1-score   support

           0       0.90      0.95      0.92       374
           1       0.60      0.42      0.49        67

    accuracy                           0.87       441
   macro avg       0.75      0.68      0.71       441
weighted avg       0.85      0.87      0.86       441

Best Parameters: {'n_estimators': 200, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_depth': 30, 'bootstrap': False}
Best Model2 Accuracy: 0.8639455782312925
Confusion Matrix:
 [[356  18]
 [ 42  25]]
Classification Report:
               precision    recall  f1-score   support

           0       0.89      0.95      0.92       374
           1       0.58      0.37      0.45        67

    accuracy                           0.86       441
   macro avg       0.74      0.66      0.69       441
weighted avg       0.85      0.86      0.85       441


Feature Importances:
                     Feature  Importance
0        AcceptedCmpOverall    0.205890
5           NumAppPurchases    0.103629
7         NumWebVisitsMonth    0.091803
6                   Recency    0.091130
4           MntMeatProducts    0.069016
2           MntRegularProds    0.065996
1                  MntTotal    0.065676
8                    Income    0.059525
3                  MntWines    0.058078
9                       Age    0.049561
11   Marital_Status_Married    0.024584
12    Marital_Status_Single    0.024068
18            Education_PhD    0.023049
13  Marital_Status_Together    0.018170
15      Education_Bachelors    0.015412
10  Marital_Status_Divorced    0.010592
17        Education_Masters    0.010340
19      Education_Secondary    0.006743
14     Marital_Status_Widow    0.005355
16     Education_HighSchool    0.001382</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Predictive_Model_files/figure-html/cell-8-output-2.png" width="952" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="step-8" class="level2">
<h2 class="anchored" data-anchor-id="step-8">step 8</h2>
<p>best model 2 is better compared to best model 1, even though they have the same over all accuracy but best model 2 is better because of higher f1score Based on the results, Model 2 (Random Forest) demonstrates superior performance compared to other models across most evaluation metrics and should be selected. With an accuracy of 87%, it correctly predicts a high proportion of instances overall. Its precision of 90% and recall of 95% for class 0 indicate strong performance in correctly identifying negatives. For class 1, while precision is 60% and recall is 42%, it performs better in capturing true positives compared to other models. The F1-score of 49% for class 1 highlights a better balance between precision and recall for positive predictions. Additionally, Model 2 shows fewer False Positives and False Negatives, leading to stronger weighted averages for precision, recall, and F1-score. These results make Random Forest the most effective and reliable choice, particularly for maximizing overall accuracy and reducing errors in the dominant class (class 0). I also ran model 2 with no SMOTE, the results were good as well: Accuracy: 88% Precision (Class 1): 76% Recall (Class 1): 33% F1-Score (Class 1): 46% False Positives (FP): 7 False Negatives (FN): 45 ### step 8 - Python</p>
<div id="c5b360b5" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and evaluate the best model with the updated function</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>best_model1 <span class="op">=</span> train_best_model1(X_train_transformed, y_train, X_test_transformed, y_test, encoded_feature_names)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>best_model2 <span class="op">=</span> train_best_model2(X_train_transformed, y_train, X_test_transformed, y_test, feature_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Best Parameters: {'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2}
Best Model1 Accuracy: 0.8639455782312925
Confusion Matrix:
 [[367   7]
 [ 53  14]]
Classification Report:
               precision    recall  f1-score   support

           0       0.87      0.98      0.92       374
           1       0.67      0.21      0.32        67

    accuracy                           0.86       441
   macro avg       0.77      0.60      0.62       441
weighted avg       0.84      0.86      0.83       441


Feature Importances:
                     Feature  Importance
0        AcceptedCmpOverall    0.682011
6                   Recency    0.157784
7         NumWebVisitsMonth    0.055405
4           MntMeatProducts    0.055164
8                    Income    0.025504
9                       Age    0.024132
13  Marital_Status_Together    0.000000
18            Education_PhD    0.000000
17        Education_Masters    0.000000
16     Education_HighSchool    0.000000
15      Education_Bachelors    0.000000
14     Marital_Status_Widow    0.000000
10  Marital_Status_Divorced    0.000000
12    Marital_Status_Single    0.000000
11   Marital_Status_Married    0.000000
1                  MntTotal    0.000000
5           NumAppPurchases    0.000000
3                  MntWines    0.000000
2           MntRegularProds    0.000000
19      Education_Secondary    0.000000</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Predictive_Model_files/figure-html/cell-9-output-2.png" width="952" height="523" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Best Parameters: {'n_estimators': 200, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_depth': 30, 'bootstrap': False}
Best Model2 Accuracy: 0.8639455782312925
Confusion Matrix:
 [[356  18]
 [ 42  25]]
Classification Report:
               precision    recall  f1-score   support

           0       0.89      0.95      0.92       374
           1       0.58      0.37      0.45        67

    accuracy                           0.86       441
   macro avg       0.74      0.66      0.69       441
weighted avg       0.85      0.86      0.85       441


Feature Importances:
                     Feature  Importance
0        AcceptedCmpOverall    0.205890
5           NumAppPurchases    0.103629
7         NumWebVisitsMonth    0.091803
6                   Recency    0.091130
4           MntMeatProducts    0.069016
2           MntRegularProds    0.065996
1                  MntTotal    0.065676
8                    Income    0.059525
3                  MntWines    0.058078
9                       Age    0.049561
11   Marital_Status_Married    0.024584
12    Marital_Status_Single    0.024068
18            Education_PhD    0.023049
13  Marital_Status_Together    0.018170
15      Education_Bachelors    0.015412
10  Marital_Status_Divorced    0.010592
17        Education_Masters    0.010340
19      Education_Secondary    0.006743
14     Marital_Status_Widow    0.005355
16     Education_HighSchool    0.001382</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Predictive_Model_files/figure-html/cell-9-output-4.png" width="952" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-9" class="level2">
<h2 class="anchored" data-anchor-id="step-9">step 9</h2>
<p>Based on the results, Model 2 (Random Forest) demonstrates superior performance across most evaluation metrics and should be selected. With an accuracy of 87%, it correctly predicts a high proportion of instances overall. For class 0, the precision of 90% and recall of 95% indicate excellent performance in identifying negatives. For class 1, the precision is 60%, and recall is 42%, demonstrating a better ability to capture true positives compared to other models. The F1-score of 49% for class 1 highlights a balanced approach between precision and recall, making Model 2 more reliable for positive predictions. Additionally, Model 2 has fewer false positives and false negatives, leading to stronger weighted averages across precision, recall, and F1-score. This makes it the most effective choice for overall accuracy and minimizing errors, especially in the dominant class (class 0).</p>
<p>When running Model 2 without SMOTE, the performance remains strong, with an accuracy of 88%. For class 1, the precision improves to 76%, although recall drops to 33%, resulting in an F1-score of 46%. The model exhibits 7 false positives and 45 false negatives, which is still an improvement compared to other models. These results confirm that Model 2 (Random Forest), both with and without SMOTE, is the most robust and balanced option for this dataset.</p>
<section id="step-9---python" class="level3">
<h3 class="anchored" data-anchor-id="step-9---python">step 9 - Python</h3>
<div id="d9aa8dd3" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> train_model2(X_train_transformed, y_train, X_test_transformed, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model2 Accuracy: 0.8684807256235828
Confusion Matrix:
 [[355  19]
 [ 39  28]]
Classification Report:
               precision    recall  f1-score   support

           0       0.90      0.95      0.92       374
           1       0.60      0.42      0.49        67

    accuracy                           0.87       441
   macro avg       0.75      0.68      0.71       441
weighted avg       0.85      0.87      0.86       441
</code></pre>
</div>
</div>
</section>
</section>
<section id="final-analysis" class="level2">
<h2 class="anchored" data-anchor-id="final-analysis">Final Analysis</h2>
<p>Interpretability:</p>
<p>The model is moderately interpretable, especially when we consider elements like feature importance and the confusion matrix. With Random Forest, we can analyze feature importance scores to determine which variables have the most significant impact on predictions. For instance, features such as income, recency, or purchase history could have higher importance, highlighting their role in predicting customer responses.</p>
<p>To explain the results to someone unfamiliar with data science, I would focus on a few key points. Firstly, the model has an overall accuracy of 87%, meaning it successfully predicts customer responses in 87 out of 100 cases. Secondly, for customers who responded positively (class 1), the model achieves a precision of 60%, meaning that 60% of the customers it predicted as responders were accurate. Its recall for class 1 is 42%, which means the model identifies 42% of all actual responders. For non-responders (class 0), the model performs better, with a precision of 90% and a recall of 95%. The confusion matrix provides a clear breakdown of correct and incorrect predictions, showing where the model performs well (e.g., high accuracy for non-responders) and where it has limitations (e.g., missing some true responders). Lastly, using feature importance helps identify key factors driving predictions, making it easier to draw actionable insights. Visual aids like bar charts and confusion matrices would be helpful to simplify these concepts and make them understandable for a non-technical audience.</p>
<p>Decisions and Limitations:</p>
<p>Based on the model’s performance, I would recommend focusing on targeted campaigns. By leveraging the model’s ability to predict responders (class 1), decision-makers can prioritize features like customer recency, spending habits, and product preferences to design campaigns that target the most likely responders effectively. Additionally, using feature importance scores, we could segment the audience further to create personalized marketing strategies, increasing the likelihood of conversion. Furthermore, resources should be allocated strategically to high-value customers identified as potential responders, ensuring a better return on investment for marketing efforts.</p>
<p>However, it is essential to communicate the limitations of the model as well. One significant limitation is the class imbalance in the dataset, which makes it harder for the model to predict positive responders (class 1) accurately, resulting in lower recall for this group. Additionally, since the model is trained on historical data, it may not generalize well to new or evolving customer behaviors. While Random Forest is accurate, it can be less interpretable compared to simpler models like Decision Trees, which could make it harder to explain the logic behind its predictions. Moreover, the default probability threshold (0.5) might not be ideal for this specific problem, and adjusting it could improve recall for responders. Finally, the accuracy of predictions depends on the quality of input data. If there is noise or if important variables influencing customer response are missing, the model’s performance could be limited. Despite these limitations, the model provides actionable insights that can help decision-makers make informed choices while keeping its constraints in mind.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>